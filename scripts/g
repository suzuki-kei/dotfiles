#!/bin/bash

set -eu

function g
{
    if [[ -z "$@" && -p /dev/stdin ]]; then
        local target="$(cat -)"
    else
        local target="$@"
    fi

    case "${target}" in
        "")
            local url="https://google.com"
            ;;
        http*)
            local url="${target}"
            ;;
        *)
            local keyword=$(echo -n ${target} | jq -sMRr '@uri')
            local url="https://www.google.com/search?q=${keyword}"
            ;;
    esac

    local chrome_options="--args --incognito"
    open -n -a "Google Chrome" ${chrome_options} "${url}"
}

g "$@"

